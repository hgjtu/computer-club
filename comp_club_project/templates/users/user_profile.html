{% extends "base.html" %}
{% load static %}

{% block title %}
  КиберСпот. Профиль.
{% endblock %}

{% block content %}
{% if user.is_authenticated and view_user == user.username %}
<div class="container mt-5">
  <div class="row">
      <div class="col-md-4 text-center">
        <img src="{{ user.img_path.url }}" alt="Фото пользователя" class="img-fluid mb-3 profile-img">
      </div>
      <div class="col-md-8">
        <h2>{{ user.username }}</h2>
        {% if user.first_name %}
            <p><strong>Имя:</strong> {{ user.first_name }}</p>
        {% endif %}
        {% if user.last_name %}
            <p><strong>Фамилия:</strong> {{ user.last_name }}</p>
        {% endif %}
        {% if user.phone_num %}
            <p><strong>Номер телефона:</strong> {{ user.phone_num }}</p>
        {% endif %}
        <p><strong>Email:</strong> {{ user.email }}</p>
        {% if user.date_of_birth %}
            <p><strong>Дата рождения:</strong> {{ user.date_of_birth }}</p>
        {% endif %}
        <a href="{% url 'users:edit' user.username %}" class="btn btn-warning">Изменить профиль</a>
      </div>
  </div>
</div>
<div class="container mt-4">
  <h2>Ваши сессии</h2>
  <form method="GET" action="{% url 'users:profile' user.username %}">
    <div class="input-group mb-3">
      <input type="text" class="form-control" name="session_id" placeholder="Номер сессии" aria-label="Номер сессии">
      <input type="text" class="form-control" name="start_time_from" placeholder="Время начала от" aria-label="Время начала от">
      <input type="text" class="form-control" name="start_time_to" placeholder="Время начала до" aria-label="Время начала до">
      <input type="text" class="form-control" name="end_time_from" placeholder="Окончание от" aria-label="Время окончания от">
      <input type="text" class="form-control" name="end_time_to" placeholder="Окончание до" aria-label="Время окончания до">
      <input type="text" class="form-control" name="servise_id" placeholder="Тип услуги" aria-label="Тип услуги">
      <input type="text" class="form-control" name="equipment_id" placeholder="Оборудование" aria-label="Оборудование">
      <button class="btn btn-outline-secondary" type="submit">Поиск</button>
      <button class="btn btn-outline-danger" type="button" id="clearButton">Очистить поиск</button>
    </div>
  </form>
  <table class="table">
    <thead>
      <tr style="text-align:center;">
        <th scope="col">Номер сессии</th>
        <th scope="col">Время начала сессии</th>
        <th scope="col">Время окончания сессии</th>
        <th scope="col">Тип услуги</th>
        <th scope="col">Оборудование</th>
      </tr>
    </thead>
  <tbody>
    {% for session in page_obj %}
      <tr  style="text-align:center;">
        <td>{{ session.id }}</td>
        <td>{{ session.start_time }}</td>
        <td>
          {% if session.end_time %}
            {{ session.end_time }}
          {% else %}
            Сессия не закончена
          {% endif %}
        </td>
        <td>{{ session.service_id }}</td>
        <td>{{ session.equipment_id }}  {{ session.service_id.pk }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="5" class="text-center">Нет результатов для отображения.</td>
      </tr>
    {% endfor %}
  </tbody>
  </table>
  {% include "includes/paginator.html" %}
</div>
<script>
  document.getElementById('clearButton').addEventListener('click', function() {
    const form = document.getElementById('searchForm');
    const inputs = form.querySelectorAll('input[type="text"]');
    inputs.forEach(input => {
      input.value = '';
    });
  });
</script>
{% else %}
  {% include "includes/none_page.html" %}
{% endif %} 

{% endblock %} 